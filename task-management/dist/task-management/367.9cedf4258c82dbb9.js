"use strict";(self.webpackChunktask_management=self.webpackChunktask_management||[]).push([[367],{2367:(et,_,s)=>{s.r(_),s.d(_,{ReportModule:()=>K});var h=s(9808),C=s(9826),b=s(3470),M=s(3609),g=s(3737),t=s(5e3),l=s(939),T=s(5482);function D(o,i){1&o&&t.GkF(0)}const x=function(o,i){return{node:o,idx:i}};function O(o,i){if(1&o&&(t.ynx(0),t.TgZ(1,"div",9),t.YNc(2,D,1,0,"ng-container",10),t.qZA(),t.BQk()),2&o){const e=i.$implicit,n=i.index;t.oxw(3);const r=t.MAs(2);t.xp6(2),t.Q6J("ngTemplateOutlet",r)("ngTemplateOutletContext",t.WLB(2,x,e,n))}}function Z(o,i){if(1&o&&(t.ynx(0),t.YNc(1,O,3,5,"ng-container",3),t.BQk()),2&o){const e=t.oxw().node;t.xp6(1),t.Q6J("ngForOf",e.children)}}function v(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"nz-table",4),t.NdJ("cdkDropListDropped",function(r){t.CHM(e);const a=t.oxw();return t.KtG(a.onDragDrop(r))}),t.TgZ(1,"thead")(2,"tr"),t._UZ(3,"th",5),t.TgZ(4,"th",5),t._uU(5,"Index"),t.qZA(),t.TgZ(6,"th",5),t._uU(7,"Id"),t.qZA(),t.TgZ(8,"th",5),t._uU(9,"T\xean"),t.qZA()()(),t.TgZ(10,"tbody")(11,"tr")(12,"td",6),t.NdJ("nzExpandChange",function(r){const a=t.CHM(e),d=a.node,c=a.idx,p=t.oxw();return t.KtG(p.onExpandChange(d.uId,r,c,d))}),t.qZA(),t.TgZ(13,"td",5),t._uU(14),t.qZA(),t.TgZ(15,"td",5),t._uU(16),t.qZA(),t.TgZ(17,"td",5),t._uU(18),t.qZA()(),t.TgZ(19,"tr",7),t.YNc(20,Z,2,1,"ng-container",8),t.qZA()()()}if(2&o){const e=i.node,n=i.idx,r=t.oxw();t.Q6J("id",e.uId)("cdkDropListData",e.children)("cdkDropListConnectedTo",r.connectedTo),t.xp6(12),t.Q6J("nzExpand",r.expandSet.has(e.uId)),t.xp6(2),t.Oqu(n),t.xp6(2),t.Oqu(e.uId),t.xp6(2),t.Oqu(e.name),t.xp6(1),t.Q6J("nzExpand",r.expandSet.has(e.uId)),t.xp6(1),t.Q6J("ngIf",e.children&&e.children.length>0)}}function L(o,i){1&o&&t.GkF(0)}function P(o,i){if(1&o&&(t.TgZ(0,"div",9),t.YNc(1,L,1,0,"ng-container",10),t.qZA()),2&o){const e=i.$implicit,n=i.index;t.oxw(2);const r=t.MAs(2);t.xp6(1),t.Q6J("ngTemplateOutlet",r)("ngTemplateOutletContext",t.WLB(2,x,e,n))}}function N(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"div")(1,"nz-collapse",11)(2,"nz-collapse-panel",12),t.NdJ("cdkDropListDropped",function(r){t.CHM(e);const a=t.oxw();return t.KtG(a.onDragDrop(r))}),t.YNc(3,P,2,5,"div",13),t.qZA()()()}if(2&o){const e=i.$implicit,n=t.oxw();t.xp6(2),t.hYB("nzHeader","[",e.uId,"] - ",e.name,""),t.Q6J("id",e.uId)("cdkDropListData",e.children)("cdkDropListConnectedTo",n.connectedTo),t.xp6(1),t.Q6J("ngForOf",e.children)}}const E=[{uId:"0",name:"Group 1",children:[{uId:"1",name:"Group 1 - 1",children:[{uId:"2",name:"Group 1 - 1 - 1",children:[{uId:"6",name:"Group 1 - 1 - 1 - 1",children:[]}]}]}]},{uId:"3",name:"Group 2",children:[{uId:"5",name:"Group 2 - 1",children:[]}]},{uId:"4",name:"Group 3",children:[]}];let A=(()=>{class o{constructor(){this.expandSet=new Set,this.onDragDrop=e=>{e.previousContainer===e.container?(console.log("move"),(0,g.bA)(e.container.data,e.previousIndex,e.currentIndex)):(console.log("trans"),(0,g.EA)(e.previousContainer.data,e.container.data,e.previousIndex,e.currentIndex))},this.root={uId:"-1",name:"root",children:E}}get connectedTo(){return this.getIdsRecursive(this.root).reverse()}ngOnInit(){}getIdsRecursive(e){let n=[e.uId];return e.children.forEach(r=>{n=n.concat(this.getIdsRecursive(r))}),n}onExpandChange(e,n,r,a){n?this.expandSet.add(e):this.expandSet.delete(e)}}return o.\u0275fac=function(e){return new(e||o)},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-task-export"]],decls:5,vars:4,consts:[[1,"task-export-wrapper"],["tmplNode",""],["cdkDropList","",3,"cdkDropListData","id","cdkDropListConnectedTo","cdkDropListDropped"],[4,"ngFor","ngForOf"],["nzTemplateMode","","cdkDropList","",3,"id","cdkDropListData","cdkDropListConnectedTo","cdkDropListDropped"],[1,"text-center"],[3,"nzExpand","nzExpandChange"],[3,"nzExpand"],[4,"ngIf"],["cdkDrag","",1,"sub-item"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["nzGhost",""],["cdkDrag","","cdkDropList","",3,"nzHeader","id","cdkDropListData","cdkDropListConnectedTo","cdkDropListDropped"],["class","sub-item","cdkDrag","",4,"ngFor","ngForOf"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0),t.YNc(1,v,21,9,"ng-template",null,1,t.W1O),t.TgZ(3,"div",2),t.NdJ("cdkDropListDropped",function(a){return n.onDragDrop(a)}),t.YNc(4,N,4,6,"div",3),t.qZA()()),2&e&&(t.xp6(3),t.Q6J("cdkDropListData",n.root.children)("id",n.root.uId)("cdkDropListConnectedTo",n.connectedTo),t.xp6(1),t.Q6J("ngForOf",n.root.children))},dependencies:[h.sg,h.O5,h.tP,l.N8,l.Uo,l._C,l.h7,l.Om,l.p0,l.$Z,l.d3,l.Vk,T.Zv,T.yH,g.Wj,g.Zt]}),o})();var I=s(5207),R=s(7480),J=s(4630),y=s(7842),S=s(8480),j=s(7957),w=s(5017),Q=s(6042),V=s(2683),F=s(2643),U=s(7484),f=s(5905),k=s(8054),m=s(2382),z=s(8197);function H(o,i){if(1&o&&t._UZ(0,"nz-option",19),2&o){const e=i.$implicit;t.Q6J("nzValue",e.name)("nzLabel",e.name)}}function Y(o,i){if(1&o&&t._UZ(0,"nz-option",19),2&o){const e=i.$implicit;t.Q6J("nzValue",e.id)("nzLabel",e.name)}}function B(o,i){if(1&o&&t._UZ(0,"nz-option",19),2&o){const e=i.$implicit;t.Q6J("nzValue",e.id)("nzLabel",e.teamName)}}function q(o,i){if(1&o&&(t.TgZ(0,"nz-card",16),t._UZ(1,"highcharts-chart",17),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.Q6J("Highcharts",e.Highcharts)("options",e.barChartOptions)}}const G=[{path:"",component:(()=>{class o{constructor(e,n,r,a,d,c){this.taskData=e,this.projectData=n,this.teamData=r,this.memberData=a,this.reportData=d,this.modalService=c,this.date=null,this.isAdvanced=!1,this.loading=!0,this.memberValue="",this.projectValue="",this.teamValue="",this.taskList=[],this.inCplTask=[],this.taskNumber=0,this.inCplTaskNumber=0,this.projectList=[],this.teamList=[],this.memberList=[],this.reportList=[],this.pageNumber=1,this.pageSize=999,this.txtProjectSearch="",this.txtTaskSearch="",this.txtTeamSearch="",this.txtMemberSearch="",this.txtReportSearch="",this.txtReportSort="",this.sortProject="",this.sortTask="",this.Highcharts=b}ngOnInit(){this.getReport(),this.getTask(),this.pieChartOption(),this.getTeam(),this.getProject(),this.getMember()}test(){this.modalService.create({nzTitle:"Test Export",nzClassName:"modal-custom",nzContent:A,nzCentered:!0,nzDirection:"ltr",nzMaskClosable:!1,nzClosable:!0,nzWidth:"1400px"})}getWeek(e){console.log("week: ",e.map(M.Z))}getTask(){this.taskData.search(this.pageNumber,this.pageSize,this.txtTaskSearch,this.sortTask).subscribe({next:e=>{console.log(e),this.taskList=e.pagingData.content},error:e=>{console.log(e)}})}getProject(){this.projectData.search(this.pageNumber,this.pageSize,this.txtProjectSearch,this.sortProject).subscribe({next:e=>{console.log(e),this.projectList=e.pagingData.content},error:e=>{console.log(e)}})}getTeam(){this.teamData.search(this.pageNumber,this.pageSize,this.txtTeamSearch).subscribe({next:e=>{console.log(e),this.teamList=e.pagingData.content},error:e=>{console.log(e)}})}getMember(){this.memberData.search(this.pageNumber,this.pageSize,this.txtMemberSearch).subscribe({next:e=>{console.log(e),this.memberList=e.pagingData.content},error:e=>{console.log(e)}})}getReport(){this.reportData.search(this.txtReportSearch,this.txtReportSort).subscribe({next:e=>{e&&(this.reportList=e.listData,this.taskNumber=e.listData.length,this.InCompleteTask(),this.barChartOption())},error:e=>{console.log(e)}})}search(){this.getReport(),this.txtReportSearch="",this.memberValue="",this.projectValue="",this.teamValue=""}getProjectValue(e){this.txtReportSearch+=`projectId.eq.${e},`}getMemberValue(e){this.txtReportSearch+=`username.eq.${e},`}getTeamValue(e){this.txtReportSearch+=`teamId.eq.${e},`}InCompleteTask(){this.inCplTask=[];for(let e=0;e<this.reportList.length;e++)0==this.reportList[e].state&&this.inCplTask.push(this.reportList[e]);this.inCplTaskNumber=this.inCplTask.length,this.pieChartOption()}exportExcel(){let e=Number(this.projectValue);this.reportData.exportExcel(e).subscribe({next:n=>{console.log(n);const r=n.type,a=[];a.push(n);const d=document.createElement("a");d.href=window.URL.createObjectURL(new Blob(a,{type:r})),d.setAttribute("download","test.xlsx"),document.body.appendChild(d),d.click()},error:n=>{console.log(n)}})}pieChartOption(){this.pieChartOptions={chart:{width:450,height:400,plotBackgroundColor:null,plotBorderWidth:null,plotShadow:!1,type:"pie"},title:{text:"T\xecnh tr\u1ea1ng d\u1ef1 \xe1n",align:"left"},tooltip:{pointFormat:"{series.name}: <b>{point.percentage:.1f}%</b>"},accessibility:{point:{valueSuffix:"%"}},plotOptions:{pie:{allowPointSelect:!0,cursor:"pointer",dataLabels:{enabled:!0,format:"<b>{point.name}</b>: {point.percentage:.1f} %"}}},series:[{name:"T\u1ed5ng s\u1ed1 Task",colorByPoint:!0,data:[{name:"Task ho\xe0n th\xe0nh",y:this.taskNumber-this.inCplTaskNumber},{name:"Task ch\u01b0a ho\xe0n th\xe0nh",y:this.inCplTaskNumber}]}]}}barChartOption(){let e=[],n=[],r=[],a=[],d=0,c=0;for(let p=0;p<this.reportList.length;p++){let u=e.find(tt=>tt.projectId==this.reportList[p].projectId);null==u?0==this.reportList[p].state?(e.push({projectId:this.reportList[p].projectId,taskDone:d,taskNotDone:++c}),c=0):(e.push({projectId:this.reportList[p].projectId,taskDone:++d,taskNotDone:c}),d=0):0==this.reportList[p].state?u.taskNotDone++:u.taskDone++}for(let p=0;p<e.length;p++)n.push(e[p].projectId),r.push(e[p].taskDone),a.push(e[p].taskNotDone);this.barChartOptions={chart:{width:450,height:400,type:"column"},title:{text:"T\xecnh tr\u1ea1ng d\u1ef1 \xe1n",align:"left"},xAxis:{categories:n},yAxis:{min:0,title:{text:"Task"},stackLabels:{enabled:!0,style:{fontWeight:"bold",textOutline:"none"}}},tooltip:{headerFormat:"<b>{point.x}</b><br/>",pointFormat:"{series.name}: {point.y}<br/>T\u1ed5ng s\u1ed1 task: {point.stackTotal}"},plotOptions:{column:{stacking:"normal",dataLabels:{enabled:!0}}},series:[{name:"Task ho\xe0n th\xe0nh",data:r},{name:"Task ch\u01b0a ho\xe0n th\xe0nh",data:a}]},this.loading=!1}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(I.h),t.Y36(R.H),t.Y36(J.d),t.Y36(y.I),t.Y36(S.h),t.Y36(j.Sf))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-report"]],decls:40,vars:16,consts:[[1,"report-wrapper"],[1,"report-header","mt-4","mb-2"],["nzPlaceHolder","Nh\xe2n vi\xean",3,"ngModel","ngModelChange"],[3,"nzValue","nzLabel",4,"ngFor","ngForOf"],["nzPlaceHolder","D\u1ef1 \xe1n",3,"ngModel","ngModelChange"],["nzPlaceHolder","Nh\xf3m",3,"ngModel","ngModelChange"],["nz-button","",1,"ml-2",3,"click"],["nzShape","circle","nz-button","",1,"filter","float-right","ml-2",3,"click"],["nz-icon","","nzType","down","nzTheme","outline",3,"hidden"],["nz-icon","","nzType","up","nzTheme","outline",3,"hidden"],[1,"report-advanced-filter","mb-4",3,"hidden"],["nzMode","week",3,"ngModel","ngModelChange"],[1,"report-detail"],[1,"card-detail","mt-3"],["nzHoverable","",1,"card-item"],[1,"chart-detail"],["nzHoverable","",1,"chart-item"],[1,"highchart",3,"Highcharts","options"],["nzHoverable","","class","chart-item",4,"ngIf"],[3,"nzValue","nzLabel"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"nz-select",2),t.NdJ("ngModelChange",function(a){return n.memberValue=a})("ngModelChange",function(a){return n.getMemberValue(a)}),t.YNc(3,H,1,2,"nz-option",3),t.qZA(),t.TgZ(4,"nz-select",4),t.NdJ("ngModelChange",function(a){return n.projectValue=a})("ngModelChange",function(a){return n.getProjectValue(a)}),t.YNc(5,Y,1,2,"nz-option",3),t.qZA(),t.TgZ(6,"nz-select",5),t.NdJ("ngModelChange",function(a){return n.teamValue=a})("ngModelChange",function(a){return n.getTeamValue(a)}),t.YNc(7,B,1,2,"nz-option",3),t.qZA(),t.TgZ(8,"button",6),t.NdJ("click",function(){return n.search()}),t._uU(9,"T\xecm ki\u1ebfm"),t.qZA(),t.TgZ(10,"button",6),t.NdJ("click",function(){return n.test()}),t._uU(11,"Test"),t.qZA(),t.TgZ(12,"button",6),t.NdJ("click",function(){return n.exportExcel()}),t._uU(13,"Xu\u1ea5t B\xe1o c\xe1o"),t.qZA(),t.TgZ(14,"button",7),t.NdJ("click",function(){return n.isAdvanced=!n.isAdvanced}),t._UZ(15,"i",8)(16,"i",9),t.qZA()(),t.TgZ(17,"div",10)(18,"nz-range-picker",11),t.NdJ("ngModelChange",function(a){return n.date=a})("ngModelChange",function(a){return n.getWeek(a)}),t.qZA()(),t.TgZ(19,"div",12)(20,"div",13)(21,"nz-card",14)(22,"h4"),t._uU(23,"T\u1ed5ng s\u1ed1 Task"),t.qZA(),t.TgZ(24,"span"),t._uU(25),t.qZA()(),t.TgZ(26,"nz-card",14)(27,"h4"),t._uU(28,"Task \u0111\xe3 ho\xe0n th\xe0nh"),t.qZA(),t.TgZ(29,"span"),t._uU(30),t.qZA()(),t.TgZ(31,"nz-card",14)(32,"h4"),t._uU(33,"Task ch\u01b0a ho\xe0n th\xe0nh"),t.qZA(),t.TgZ(34,"span"),t._uU(35),t.qZA()()(),t.TgZ(36,"div",15)(37,"nz-card",16),t._UZ(38,"highcharts-chart",17),t.qZA(),t.YNc(39,q,2,2,"nz-card",18),t.qZA()()()),2&e&&(t.xp6(2),t.Q6J("ngModel",n.memberValue),t.xp6(1),t.Q6J("ngForOf",n.memberList),t.xp6(1),t.Q6J("ngModel",n.projectValue),t.xp6(1),t.Q6J("ngForOf",n.projectList),t.xp6(1),t.Q6J("ngModel",n.teamValue),t.xp6(1),t.Q6J("ngForOf",n.teamList),t.xp6(8),t.Q6J("hidden",n.isAdvanced),t.xp6(1),t.Q6J("hidden",!n.isAdvanced),t.xp6(1),t.Q6J("hidden",!n.isAdvanced),t.xp6(1),t.Q6J("ngModel",n.date),t.xp6(7),t.Oqu(n.taskNumber),t.xp6(5),t.Oqu(n.taskNumber-n.inCplTaskNumber),t.xp6(5),t.Oqu(n.inCplTaskNumber),t.xp6(3),t.Q6J("Highcharts",n.Highcharts)("options",n.pieChartOptions),t.xp6(1),t.Q6J("ngIf",!n.loading&&n.barChartOptions))},dependencies:[h.sg,h.O5,w.Ls,Q.ix,V.w,F.dQ,U.bd,f.uw,f.wS,k.Ip,k.Vq,m.JJ,m.On,z.x],styles:[".report-wrapper[_ngcontent-%COMP%]{width:100%;padding:0 48px;margin-bottom:48px}.report-wrapper[_ngcontent-%COMP%]   .report-header[_ngcontent-%COMP%]{display:flex;justify-content:space-around}.report-wrapper[_ngcontent-%COMP%]   .report-header[_ngcontent-%COMP%]   nz-select[_ngcontent-%COMP%]{margin:0 8px 10px 0;width:24%}.report-wrapper[_ngcontent-%COMP%]   .report-header[_ngcontent-%COMP%]   .filter[_ngcontent-%COMP%]     .anticon svg{margin-bottom:5px}.report-wrapper[_ngcontent-%COMP%]   .report-advanced-filter[_ngcontent-%COMP%]   nz-range-picker[_ngcontent-%COMP%]{width:50.6%}.report-wrapper[_ngcontent-%COMP%]   .report-detail[_ngcontent-%COMP%]{width:100%;display:flex;flex-direction:column;gap:25px}.report-wrapper[_ngcontent-%COMP%]   .report-detail[_ngcontent-%COMP%]   .card-detail[_ngcontent-%COMP%]{width:100%;display:inline-flex;gap:25px}.report-wrapper[_ngcontent-%COMP%]   .report-detail[_ngcontent-%COMP%]   .card-detail[_ngcontent-%COMP%]   .card-item[_ngcontent-%COMP%]{width:33%;height:200px;border:1px solid #edeae9!important;border-radius:8px}.report-wrapper[_ngcontent-%COMP%]   .report-detail[_ngcontent-%COMP%]   .card-detail[_ngcontent-%COMP%]   .card-item[_ngcontent-%COMP%]     .ant-card-body{display:flex;flex-direction:column;justify-content:center;align-items:center;height:100%;width:100%}.report-wrapper[_ngcontent-%COMP%]   .report-detail[_ngcontent-%COMP%]   .card-detail[_ngcontent-%COMP%]   .card-item[_ngcontent-%COMP%]     .ant-card-body h4{font-size:20px;line-height:28px;font-weight:400}.report-wrapper[_ngcontent-%COMP%]   .report-detail[_ngcontent-%COMP%]   .card-detail[_ngcontent-%COMP%]   .card-item[_ngcontent-%COMP%]     .ant-card-body span{font-size:48px;line-height:56px;font-weight:300}.report-wrapper[_ngcontent-%COMP%]   .report-detail[_ngcontent-%COMP%]   .chart-detail[_ngcontent-%COMP%]{width:100%;display:inline-flex;gap:25px}.report-wrapper[_ngcontent-%COMP%]   .report-detail[_ngcontent-%COMP%]   .chart-detail[_ngcontent-%COMP%]   .chart-item[_ngcontent-%COMP%]{width:50%;height:450px;border:1px solid #edeae9!important;border-radius:8px;display:flex;justify-content:center}"]}),o})()}];let W=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[C.Bz.forChild(G),C.Bz]}),o})();var $=s(9923),X=s(9201);let K=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[h.ez,W,$.v,X.V,m.UX,m.u5,z.l,g._t]}),o})()}}]);